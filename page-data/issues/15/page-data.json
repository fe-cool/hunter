{
    "componentChunkName": "component---src-templates-issues-tsx",
    "path": "/issues/15",
    "result": {"data":{"issuesJson":{"id":"804018dd-f8e1-5a11-b011-45ffa2f08070","title":"å®ç°MyNewæ–¹æ³•","number":15,"bodyHTML":"\n<h3 dir=\"auto\">è¦å®ç°çš„åŠŸèƒ½</h3>\n<p dir=\"auto\">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class=\"notranslate\">new</code>å®ä¾‹åŒ–ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¯·æ ¹æ®<strong>å®ä¾‹åŒ–è¿‡ç¨‹ä¸­æ„é€ å‡½æ•°å†…éƒ¨å·¥ä½œæµç¨‹</strong>ï¼Œå®ç°ç±»ä¼¼åŠŸèƒ½çš„<code class=\"notranslate\">MyNew</code>æ–¹æ³•ã€‚</p>\n\n<h3 dir=\"auto\">ä»£ç ç¤ºä¾‹</h3>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew(fn, ...args) {\n  // å®ç°...\n}\n\nfunction Person(name, age) {\n  this.name = name;\n  this.age = age;\n}\nconst kasong = MyNew(Person, 'KaSong', 18);\nconsole.log(kasong.age); // 18\n\nfunction Something(name) {\n  this.name = name;\n  return {name: 'something'};\n}\nconst something = MyNew(Something, 'XiaoMing');\nconsole.log(something.name); // something\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">// å®ç°...</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">kasong</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'KaSong'</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">18</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">kasong</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span> <span class=\"pl-c\">// 18</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Something</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">{</span><span class=\"pl-c1\">name</span>: <span class=\"pl-s\">'something'</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">something</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Something</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'XiaoMing'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">something</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span> <span class=\"pl-c\">// something</span></pre></div>\n\n<h3 dir=\"auto\">é—®é¢˜è¡¥å……</h3>\n \n<ol dir=\"auto\">\n<li>è¯·é˜è¿°<strong>å®ä¾‹åŒ–è¿‡ç¨‹ä¸­æ„é€ å‡½æ•°å†…éƒ¨å·¥ä½œæµç¨‹</strong></li>\n<li>è¯·å†™å‡ºä»£ç ï¼Œå¹¶ä¸ºä»£ç çš„å…³é”®æ­¥éª¤å¢å†™æ³¨é‡Š</li>\n<li>é™„å¸¦æµ‹è¯•ç”¨ä¾‹æ˜¯åŠ åˆ†é¡¹</li>\n<li>ä¸éœ€è¦è€ƒè™‘å¼‚å¸¸å‘ç”Ÿ</li>\n<li>ä¸è¿‡åº¦è®¾è®¡ï¼Œä»£ç ç®€æ´ä¼˜é›…æ˜¯åŠ åˆ†é¡¹</li>\n</ol>\n<h2 dir=\"auto\">æœ€ä½³ç­”æ¡ˆ</h2>\n<p dir=\"auto\"><a href=\"https://github.com/BetaSu/fe-hunter/issues/15#issuecomment-1078625200\" data-hovercard-type=\"issue\" data-hovercard-url=\"/BetaSu/fe-hunter/issues/15/hovercard\">Chorerçš„å›ç­”</a></p>\n<p dir=\"auto\">ç†ç”±ï¼šå®ç°å®Œå¤‡ï¼Œä¸”åŒ…å«é—®é¢˜è¡¥å……ä¸­çš„æ‰€æœ‰è¦ç´ </p>\n<h3 dir=\"auto\">ç­”é¢˜åŒå­¦é¡»çŸ¥</h3>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\">ç­”é¢˜è§„èŒƒï¼šè¯·åœ¨<code class=\"notranslate\">ä¸€æ¬¡è¯„è®º</code>ä¸­å®Œæˆä½œç­”ï¼Œåç»­ä¿®æ”¹ä¹Ÿè¯·ç¼–è¾‘è¯¥è¯„è®ºï¼Œè€Œä¸æ˜¯è¿½åŠ æ–°çš„è¯„è®º</p>\n</li>\n<li>\n<p dir=\"auto\">è¯„é€‰æ ‡å‡†ï¼šæœ€ä½³ç­”æ¡ˆç”±<code class=\"notranslate\">å›´è§‚åŒå­¦</code>çš„ <g-emoji class=\"g-emoji\" alias=\"+1\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png\">ğŸ‘</g-emoji> å’Œ<a href=\"https://github.com/BetaSu\">å¡é¢‚</a>å…±åŒå†³å®š</p>\n</li>\n<li>\n<p dir=\"auto\">è¯„é€‰æ—¶é—´ï¼šä¸€èˆ¬æ˜¯å½“æ—¥18ï¼š00å·¦å³è¯„é€‰ï¼Œå¦‚æœé—®é¢˜å‘å¸ƒå½“å¤©å›ç­”æ•°è¾ƒå°‘ï¼Œé—®é¢˜æ‚¬èµé‡‘é¢å¯èƒ½å¢åŠ ï¼ŒåŒæ—¶æ‚¬èµæ—¶é—´ä¹Ÿä¼šå¢åŠ </p>\n</li>\n</ul>\n<h3 dir=\"auto\">å›´è§‚åŒå­¦é¡»çŸ¥</h3>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\">å¯¹äºä½ æ»¡æ„çš„ç­”æ¡ˆï¼Œè¯·ä¸è¦åæƒœä½ çš„ <g-emoji class=\"g-emoji\" alias=\"+1\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png\">ğŸ‘</g-emoji>ï¼Œè¿™æ˜¯è¯„é€‰<strong>æœ€ä½³ç­”æ¡ˆ</strong>çš„ä¾æ®</p>\n</li>\n<li>\n<p dir=\"auto\"><code class=\"notranslate\">éç­”é¢˜çš„è¯„è®º</code>ä¼šè¢«åˆ é™¤ï¼Œé—®é¢˜ç›¸å…³è®¨è®ºè¯·åœ¨<a href=\"https://github.com/BetaSu/fe-hunter\">èµé‡‘çŒäººç¾¤</a>ä¸­è¿›è¡Œ</p>\n</li>\n</ul>","updatedAt":"2022-03-25T16:40:46Z","upvoteCount":null,"author":{"login":"BetaSu","avatarUrl":"https://avatars.githubusercontent.com/u/15828041?u=3b08cdf9f9b49dbead9ffb020a94d925904d2b74&v=4","url":"https://github.com/BetaSu"},"category":null,"labels":{"edges":[{"node":{"name":"JS","color":"ffee58"}},{"node":{"name":"åŠ¨æ‰‹","color":"42a5f5"}}]},"comments":{"edges":[{"node":{"id":"IC_kwDOHCfdf85ASbSu","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function PolyfillNew(fn, ...args) {\n  // å¦‚æœä¸æ˜¯å‡½æ•°æŠ¥é”™\n  if (typeof fn !== 'function') {\n    throw TypeError(`Expected a function, but got a ${typeof fn}`)\n  }\n  // åˆ›å»ºæ–°å¯¹è±¡,å¹¶ä¿®æ”¹æ–°å¯¹è±¡çš„åŸå‹\n  const o = Object.create(fn.prototype)\n  // ä»¥æ–°å¯¹è±¡ä½œä¸º this è°ƒç”¨å‡½æ•°\n  const r = fn.apply(o, args)\n  const t = typeof r\n  // å¦‚æœå‡½æ•°è¿”å›å€¼ä¸ºå¯¹è±¡æˆ–å‡½æ•°åˆ™è¿”å›,å¦åˆ™è¿”å›æ–°å¯¹è±¡\n  return (r !== null &amp;&amp; t === 'object') || t === 'function' ? r : o\n}\n\nfunction Person(name, age) {\n  this.name = name\n  this.age = age\n}\nconst kasong = PolyfillNew(Person, 'KaSong', 18)\nconsole.log(kasong.age) // 18\n\nfunction Something(name) {\n  this.name = name\n  return { name: 'something' }\n}\nconst something = PolyfillNew(Something, 'XiaoMing')\nconsole.log(something.name) // something\n\nfunction Others(name) {\n  this.name = name\n  return function test() {\n    console.log(this)\n  }\n}\n\nconst others = PolyfillNew(Others, 'others')\nconsole.log(others)\n// Æ’ test() {\n//  console.log(this)\n// }\n\nconst others2 = new Others('others2')\nconsole.log(others2)\n// Æ’ test() {\n//  console.log(this)\n// }\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">PolyfillNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">// å¦‚æœä¸æ˜¯å‡½æ•°æŠ¥é”™</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">fn</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">throw</span> <span class=\"pl-v\">TypeError</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">`Expected a function, but got a <span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">}</span></span>`</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span>\n  <span class=\"pl-c\">// åˆ›å»ºæ–°å¯¹è±¡,å¹¶ä¿®æ”¹æ–°å¯¹è±¡çš„åŸå‹</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">o</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// ä»¥æ–°å¯¹è±¡ä½œä¸º this è°ƒç”¨å‡½æ•°</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">r</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">t</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">r</span>\n  <span class=\"pl-c\">// å¦‚æœå‡½æ•°è¿”å›å€¼ä¸ºå¯¹è±¡æˆ–å‡½æ•°åˆ™è¿”å›,å¦åˆ™è¿”å›æ–°å¯¹è±¡</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">t</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">||</span> <span class=\"pl-s1\">t</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'function'</span> ? <span class=\"pl-s1\">r</span> : <span class=\"pl-s1\">o</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">kasong</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">PolyfillNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'KaSong'</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">18</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">kasong</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\">// 18</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Something</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">{</span> <span class=\"pl-c1\">name</span>: <span class=\"pl-s\">'something'</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">something</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">PolyfillNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Something</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'XiaoMing'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">something</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\">// something</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Others</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-k\">function</span> <span class=\"pl-en\">test</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">this</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">others</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">PolyfillNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Others</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'others'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">others</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\">// Æ’ test() {</span>\n<span class=\"pl-c\">//  console.log(this)</span>\n<span class=\"pl-c\">// }</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">others2</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Others</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'others2'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">others2</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\">// Æ’ test() {</span>\n<span class=\"pl-c\">//  console.log(this)</span>\n<span class=\"pl-c\">// }</span></pre></div>","author":{"login":"vfiee","avatarUrl":"https://avatars.githubusercontent.com/u/42051272?u=c466fca38de5663acb520c4a0af0d2d8515ec79b&v=4","url":"https://github.com/vfiee"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASdAY","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\" const MyNew = (constructor, ...args) =&gt; {\n    const obj = Object.create(constructor.prototype)\n\n    constructor.apply(obj, args)\n\n    return obj\n}\n\"><pre class=\"notranslate\"> <span class=\"pl-k\">const</span> <span class=\"pl-v\">MyNew</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">obj</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"vanstline","avatarUrl":"https://avatars.githubusercontent.com/u/26602636?u=1d7276096f8dd6b8352e1b3f1734a313ae0c7147&v=4","url":"https://github.com/vanstline"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASdwC","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(constructor) {\n  var _args = Array.prototype.slice.call(arguments, 1)\n  var _this = {}\n\n  _this.__proto__ = constructor.prototype\n\n  var res = constructor.apply(_this, _args)\n\n  return res !== null &amp;&amp; typeof res === 'object' ? res : _this\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">var</span> <span class=\"pl-s1\">_args</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Array</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">slice</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">arguments</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">var</span> <span class=\"pl-s1\">_this</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-s1\">_this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">__proto__</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span>\n\n  <span class=\"pl-k\">var</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">constructor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">_this</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">_args</span><span class=\"pl-kos\">)</span>\n\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">res</span> : <span class=\"pl-s1\">_this</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"Stan9726","avatarUrl":"https://avatars.githubusercontent.com/u/56797239?u=0c3a8acf568a72651a0733f358294a8514a1a0c4&v=4","url":"https://github.com/Stan9726"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASdxd","bodyHTML":"<p dir=\"auto\">æ­£å¥½æˆ‘æœ€è¿‘åœ¨å­¦ä¹ è¿™å—ï¼Œå°±æ¥å°è¯•ä¸‹~</p>\n<p dir=\"auto\"><code class=\"notranslate\">new</code>æ“ä½œç¬¦ç©¶ç«Ÿå¹²äº†å•¥ï¼Ÿ</p>\n<ol dir=\"auto\">\n<li>æ–°å»ºä¸€ä¸ªå¯¹è±¡</li>\n<li>æŠŠæ–°å¯¹è±¡çš„<code class=\"notranslate\">[[Prototype]]</code>å±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„<code class=\"notranslate\">prototype</code>å±æ€§</li>\n<li>ç”¨æ–°å¯¹è±¡çš„ä¸Šä¸‹æ–‡æ‰§è¡Œæ„é€ å‡½æ•°</li>\n<li>è¿”å›æ–°å¯¹è±¡</li>\n</ol>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(constructorFunction, ...args) {\n  const res = {}\n  Object.setPrototypeOf(res, constructorFunction.prototype)\n  constructorFunction.apply(res, args)\n  return res\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">constructorFunction</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n  <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">setPrototypeOf</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">res</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">constructorFunction</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">constructorFunction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">res</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">æœ‰äººå®ç°<code class=\"notranslate\">myNew</code>è¿˜ä¼šçœ‹æ„é€ å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœæ˜¯å¯¹è±¡è¿˜æœ‰ç‰¹æ®Šæ“ä½œï¼Œä½†æˆ‘ä¸ªäººä¸çŸ¥é“è¿™æ ·åšçš„æ„ä¹‰ï¼Œä¸ºä»€ä¹ˆè¦åœ¨æ„é€ å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿæ„é€ å‡½æ•°å°±ä¸åº”è¯¥æœ‰è¿”å›å€¼çš„å‘€ã€‚æ‰€ä»¥æˆ‘æ²¡æœ‰å®ç°è¿™å—ï¼Œä¹Ÿä½¿å¾—ä»£ç æ›´ç®€å•äº†ä¸€äº›ã€‚</p>\n<p dir=\"auto\">è¿˜æœ‰ä¹Ÿä¸å¤ªæ‡‚é¢˜ç›®ä¸­ <code class=\"notranslate\">myNew</code> ä¸ºå•¥é¦–å­—æ¯å¤§å†™ï¼Œè¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªç±»å‘€ <g-emoji class=\"g-emoji\" alias=\"joy\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f602.png\">ğŸ˜‚</g-emoji></p>","author":{"login":"acmu","avatarUrl":"https://avatars.githubusercontent.com/u/35673748?u=66b8da57cfefd536591a2394958c4b18aa9258f9&v=4","url":"https://github.com/acmu"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASd1H","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew (cto, ...rest) {\n    let isFun = (cto) =&gt; typeof cto === 'function'\n    let isObj = (param) =&gt; typeof param === 'object' &amp;&amp; param !== null\n    if (!isFun(cto)) return 'the first param must be a function'\n    MyNew.target = cto \n    let obj = Object.create(cto.prototype)\n    let res = cto.apply(obj, rest)\n\n    if (isFun(res) || isObj(res)) return res\n    return obj\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">cto</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">rest</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-en\">isFun</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">cto</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">cto</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'function'</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-en\">isObj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">param</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">param</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">param</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">!</span><span class=\"pl-en\">isFun</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">cto</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">return</span> <span class=\"pl-s\">'the first param must be a function'</span>\n    <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">cto</span> \n    <span class=\"pl-k\">let</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">cto</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">cto</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">rest</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-en\">isFun</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">res</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">||</span> <span class=\"pl-en\">isObj</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">res</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">obj</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"ninenan","avatarUrl":"https://avatars.githubusercontent.com/u/43817696?u=15c19258df72b15e965228815ccd36c5c955701a&v=4","url":"https://github.com/ninenan"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASd3M","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(fn, ...args) {\n  let obj = Object.create(fn.prototype);\n\n  let result = fn.apply(obj, args);\n\n  return result instanceof Object ? result : obj;\n}\n`\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">result</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n`</pre></div>","author":{"login":"lingdeqingyuan","avatarUrl":"https://avatars.githubusercontent.com/u/47544789?u=2e6c20bde65549629bd619c588ff14950ae9eee2&v=4","url":"https://github.com/lingdeqingyuan"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASeBn","bodyHTML":"<p dir=\"auto\">åœ¨è°ƒç”¨ new çš„è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿä»¥ä¸‹å››ä»¶äº‹æƒ…ï¼š</p>\n<ol dir=\"auto\">\n<li>æ–°ç”Ÿæˆäº†ä¸€ä¸ªå¯¹è±¡</li>\n<li>é“¾æ¥åˆ°åŸå‹</li>\n<li>æ”¹å˜thisæ‰§è¡Œ</li>\n<li>è¿”å›æ–°å¯¹è±¡</li>\n</ol>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew(ctor) {\n    if(typeof ctor !== 'function') {\n      throw 'ctor must be a function';\n    }\n    let obj =  Object.create(ctor.prototype); //1-2\n    let res = ctor.apply(obj, arguments);//3\n    return res instanceof Object ? res : obj;//4\n};\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ctor</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">if</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">ctor</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-k\">throw</span> <span class=\"pl-s\">'ctor must be a function'</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-kos\">}</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span>  <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ctor</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span> <span class=\"pl-c\">//1-2</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">ctor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-smi\">arguments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span><span class=\"pl-c\">//3</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">res</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span><span class=\"pl-c\">//4</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">;</span></pre></div>","author":{"login":"Picsong","avatarUrl":"https://avatars.githubusercontent.com/u/49096360?u=bcb640e20fb6fedca1181fc4803b9f829f30284e&v=4","url":"https://github.com/Picsong"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASeW_","bodyHTML":"<p dir=\"auto\">é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code class=\"notranslate\">new</code> æ“ä½œèµ·äº†ä»€ä¹ˆä½œç”¨</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// æ„é€ å‡½æ•° People (æ— æ˜¾å¼è¿”å›å€¼)\nfunction People(name, age) {\n  this.name = name\n  this.age = age\n}\n\nPeople.prototype.printInfo = function () {\n  return `My name is ${this.name} and ${this.age}`\n}\n\n// æ„é€ å‡½æ•° Student (æœ‰æ˜¾å¼è¿”å›å€¼ï¼Œä¸”è¿”å›å€¼ä¸ºå¯¹è±¡ç±»å‹)\nfunction Student(name) {\n  this.name = name\n  return { ps: 'balabala' }\n}\n\nconst p1 = new People('Jack', 17)\nconst s1 = new Student('David')\nconsole.log(p1.name)        // Jack\nconsole.log(p1.age)         // 17\nconsole.log(p1.printInfo()) // My name is Jack and 17\nconsole.log(s1)             // {ps: &quot;balabala&quot;}\"><pre class=\"notranslate\"><span class=\"pl-c\">// æ„é€ å‡½æ•° People (æ— æ˜¾å¼è¿”å›å€¼)</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">People</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-v\">People</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">printInfo</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">function</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-s\">`My name is <span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">}</span></span> and <span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span><span class=\"pl-kos\">}</span></span>`</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-c\">// æ„é€ å‡½æ•° Student (æœ‰æ˜¾å¼è¿”å›å€¼ï¼Œä¸”è¿”å›å€¼ä¸ºå¯¹è±¡ç±»å‹)</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Student</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">{</span> <span class=\"pl-c1\">ps</span>: <span class=\"pl-s\">'balabala'</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">p1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">People</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'Jack'</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">17</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">s1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Student</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'David'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">p1</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span>        <span class=\"pl-c\">// Jack</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">p1</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span><span class=\"pl-kos\">)</span>         <span class=\"pl-c\">// 17</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">p1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">printInfo</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\">// My name is Jack and 17</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">s1</span><span class=\"pl-kos\">)</span>             <span class=\"pl-c\">// {ps: \"balabala\"}</span></pre></div>\n<p dir=\"auto\">å¯ä»¥çœ‹å‡º <code class=\"notranslate\">new</code> å…³é”®å­—å¤§ä½“ä¸Šæœ‰ä¸€ä¸‹å‡ ä¸ªä½œç”¨</p>\n<ul dir=\"auto\">\n<li>æ„é€ å‡½æ•°æ— æ˜¾å¼è¿”å›å€¼æ—¶ï¼ˆä¾‹å¦‚ <code class=\"notranslate\">Person</code>ï¼‰ï¼Œé€šè¿‡ <code class=\"notranslate\">new</code> æ“ä½œå¾—åˆ°çš„ <code class=\"notranslate\">p1</code> å¯ä»¥è®¿é—®åˆ°æ„é€ å‡½æ•° <code class=\"notranslate\">Person</code> é‡Œçš„å±æ€§å’Œ <code class=\"notranslate\">Person.prototype</code> é‡Œçš„å±æ€§</li>\n<li>æ„é€ å‡½æ•°æœ‰æ˜¾å¼è¿”å›å€¼å¹¶ä¸”è¿”å›å€¼ä¸ºå¯¹è±¡ç±»å‹æ—¶ï¼ˆä¾‹å¦‚ <code class=\"notranslate\">Student</code>ï¼‰ï¼Œé€šè¿‡ <code class=\"notranslate\">new</code> æ“ä½œå¾—åˆ°çš„ <code class=\"notranslate\">s1</code> æ˜¯æ„é€ å‡½æ•°çš„æ˜¾ç¤ºè¿”å›å€¼ <code class=\"notranslate\">{ps: \"balabala\"}</code></li>\n</ul>\n<p dir=\"auto\">åŸºäºä»¥ä¸Šçš„å†…å®¹ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ª <code class=\"notranslate\">new</code> æ“ä½œ</p>\n<ol dir=\"auto\">\n<li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°†ä¼šä½œä¸ºæ‰§è¡Œ <code class=\"notranslate\">new æ„é€ å‡½æ•°()</code> ä¹‹åï¼Œè¿”å›çš„å¯¹è±¡å®ä¾‹</li>\n<li>å°†ä¸Šé¢åˆ›å»ºçš„ç©ºå¯¹è±¡çš„åŸå‹ï¼ˆ<code class=\"notranslate\">__proto__</code>ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„ prototype å±æ€§</li>\n<li>å°†è¿™ä¸ªç©ºå¯¹è±¡èµ‹å€¼ç»™æ„é€ å‡½æ•°å†…éƒ¨çš„ <code class=\"notranslate\">this</code>ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°é€»è¾‘</li>\n<li>æ ¹æ®æ„é€ å‡½æ•°æ‰§è¡Œé€»è¾‘ï¼Œè¿”å›ç¬¬ä¸€æ­¥åˆ›å»ºçš„å¯¹è±¡æˆ–è€…æ„é€ å‡½æ•°çš„æ˜¾å¼è¿”å›å€¼</li>\n</ol>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const MyNew = (Con, ...args) =&gt; {\n  const obj = Object.create(Con.prototype)\n  const result = Con.apply(obj, args)\n  return typeof result === 'object' ? result : obj\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">const</span> <span class=\"pl-v\">MyNew</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Con</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Con</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Con</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">obj</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"emotionl","avatarUrl":"https://avatars.githubusercontent.com/u/17172758?u=14fb759df59131a3dba17af4f0b73bbffff0c0c0&v=4","url":"https://github.com/emotionl"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASe90","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/**\n * @param {function} fn target function\n * @param {any} fnArgs function rest arguments\n * @returns {Object}\n */\nfunction MyNew(fn, ...fnArgs) {\n  const PROTOTYPE_OBJECT = Object.create(null);\n  if (typeof fn !== 'function') {\n    return PROTOTYPE_OBJECT;\n  }\n  try {\n    const RESULT = fn.apply(PROTOTYPE_OBJECT, fnArgs);\n    return RESULT instanceof Object ? RESULT : PROTOTYPE_OBJECT;\n  } catch (error) {\n    return PROTOTYPE_OBJECT;\n  }\n}\"><pre class=\"notranslate\"><span class=\"pl-c\">/**</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@param</span> {<span class=\"pl-smi\">function</span>} fn target function</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@param</span> {<span class=\"pl-smi\">any</span>} fnArgs function rest arguments</span>\n<span class=\"pl-c\"> * <span class=\"pl-k\">@returns</span> {<span class=\"pl-smi\">Object</span>}</span>\n<span class=\"pl-c\"> */</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">fnArgs</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">PROTOTYPE_OBJECT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">null</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">fn</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">PROTOTYPE_OBJECT</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">try</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-c1\">RESULT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">PROTOTYPE_OBJECT</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fnArgs</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">RESULT</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-c1\">RESULT</span> : <span class=\"pl-c1\">PROTOTYPE_OBJECT</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span> <span class=\"pl-k\">catch</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">error</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">PROTOTYPE_OBJECT</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"tangdingga1","avatarUrl":"https://avatars.githubusercontent.com/u/37588992?u=d2101c2a97ef7a42be34822f2b2c90bc86c744fe&v=4","url":"https://github.com/tangdingga1"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASfkF","bodyHTML":"<p dir=\"auto\">å®ä¾‹åŒ–è¿‡ç¨‹ä¸­æ„é€ å‡½æ•°å†…éƒ¨å·¥ä½œæµç¨‹ï¼š</p>\n<ol dir=\"auto\">\n<li>åˆ›å»ºæ–°å¯¹è±¡ï¼Œä½¿ç”¨æ„é€ å‡½æ•°çš„åŸå‹ä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹å¯¹è±¡</li>\n<li>å°†æ–°çš„å¯¹è±¡ä½œä¸ºå‡½æ•°çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆthisï¼‰</li>\n<li>æ‰§è¡Œå‡½æ•°ä¸­çš„ä»£ç </li>\n<li>å°†æ–°å»ºçš„å¯¹è±¡è¿”å›</li>\n</ol>\n<p dir=\"auto\">å®ç°ï¼š</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew(fn, ...args) {\n  const result = Object.create(fn.prototype) // åˆ›å»ºæ–°å¯¹è±¡ï¼Œä½¿ç”¨æ„é€ å‡½æ•°çš„åŸå‹ä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹å¯¹è±¡\n  const obj = fn.apply(result, args)\n  // å¼•ç”¨ç±»å‹ç›´æ¥è¿”å›\n  return (typeof obj === 'object' &amp;&amp; obj !== null || typeof obj === 'function') ? obj : result\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\">// åˆ›å»ºæ–°å¯¹è±¡ï¼Œä½¿ç”¨æ„é€ å‡½æ•°çš„åŸå‹ä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹å¯¹è±¡</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">result</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// å¼•ç”¨ç±»å‹ç›´æ¥è¿”å›</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span> <span class=\"pl-c1\">||</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span> ? <span class=\"pl-s1\">obj</span> : <span class=\"pl-s1\">result</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">å•æµ‹ï¼š</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"describe('MyNew', () =&gt; {\n  it('should be defined', () =&gt; {\n    expect(MyNew).toBeDefined()\n  })\n  it('should work on common constructor', () =&gt; {\n    function Person(name, age) {\n      this.name = name\n      this.age = age\n    }\n    const result = MyNew(Person, 'KaSong', 18)\n    expect(result.age).toBe(18)\n  })\n  it('should work on constructor return object', () =&gt; {\n    function Something(name) {\n      this.name = name\n      return { name: 'something' }\n    }\n    const result = MyNew(Something, 'XiaoMing')\n    expect(result.name).toBe('something')\n  })\n})\"><pre class=\"notranslate\"><span class=\"pl-en\">describe</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'MyNew'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-en\">it</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'should be defined'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeDefined</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-en\">it</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'should work on common constructor'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n      <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span>\n    <span class=\"pl-kos\">}</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'KaSong'</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">18</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBe</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">18</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-en\">it</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'should work on constructor return object'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">function</span> <span class=\"pl-v\">Something</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n      <span class=\"pl-k\">return</span> <span class=\"pl-kos\">{</span> <span class=\"pl-c1\">name</span>: <span class=\"pl-s\">'something'</span> <span class=\"pl-kos\">}</span>\n    <span class=\"pl-kos\">}</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Something</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'XiaoMing'</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBe</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'something'</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span></pre></div>","author":{"login":"andyyxw","avatarUrl":"https://avatars.githubusercontent.com/u/41931722?u=d11913a45891fb02f1e35743231536adc079a405&v=4","url":"https://github.com/andyyxw"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASf21","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(fn, ...args) {\n  if (typeof fn !== 'function') throw new Error('fn nust be a function');\n  const obj = Object.create(fn.prototype);\n  const result = fn.apply(obj, args);\n  return (typeof result === 'object' &amp;&amp; result !== null) || typeof result === 'function' ? result : obj;\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">fn</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Error</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'fn nust be a function'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">||</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'function'</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"fxwing","avatarUrl":"https://avatars.githubusercontent.com/u/32068860?u=77df1f2776ae063e0d954db1e4600bf83afcb5ea&v=4","url":"https://github.com/fxwing"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85AShWp","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(fn, ...args) {\n    const obj = Object.create(fn.prototype)\n    let result = fn.apply(obj, args)\n    return result instanceof Object ? result : obj\n}\n\næµ‹è¯•ï¼š\nfunction Person(name, age) {\n    this.name = name;\n    this.age = age;\n}\nPerson.prototype.say = function () {\n    console.log(this.name)\n}\n\nlet p = mynew(Person, &quot;su&quot;, 123)\nconsole.log(p) // Person {name: &quot;su&quot;, age: 123}\np.say()  // &quot;su&quot;\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">let</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">result</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">obj</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-s1\">æµ‹è¯•ï¼š</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">say</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">function</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">let</span> <span class=\"pl-s1\">p</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">mynew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"su\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">123</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">p</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\">// Person {name: \"su\", age: 123}</span>\n<span class=\"pl-s1\">p</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">say</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span>  <span class=\"pl-c\">// \"su\"</span></pre></div>","author":{"login":"ZHENGGEGE","avatarUrl":"https://avatars.githubusercontent.com/u/20240270?u=3d3be0023b60bea1fd34c800d21b7cff0629b614&v=4","url":"https://github.com/ZHENGGEGE"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASijD","bodyHTML":"<p dir=\"auto\">æ¥ä¸ªå‡½æ•°å¼çš„</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const mynew = (fn, ...arg) =&gt; \n  (((ctx) =&gt; \n    (result =&gt; typeof result === 'object' ? result : ctx)\n    (fn.apply(ctx, arg)))\n  ({ __proto__: fn.prototype }))\n\n\nfunction mynew(fn, ...arg){\n  const ctx = { __proto__: fn.prototype }\n  const result = fn.apply(ctx, arg)\n  return typeof result === 'object' ? result : ctx\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">const</span> <span class=\"pl-en\">mynew</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">arg</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> \n  <span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> \n    <span class=\"pl-kos\">(</span><span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">arg</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-c1\">__proto__</span>: <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n\n\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">mynew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">arg</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">ctx</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span> <span class=\"pl-c1\">__proto__</span>: <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">arg</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">ctx</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"NoBey","avatarUrl":"https://avatars.githubusercontent.com/u/10740524?u=6c74b36db878e34c1cf8d1b6e638285b11c1f3b6&v=4","url":"https://github.com/NoBey"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASkZM","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(fn, ...args) {\n  // åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼ŒåŒæ—¶ç»‘å®šåŸå‹\n  const obj = Object.create(fn.prototype)\n  // æ‰§è¡Œæ„é€ å‡½æ•°\n  const result = fn.apply(obj, args);\n  // è¿”å›æ„é€ ç»“æœæˆ–ä¸´æ—¶å¯¹è±¡\n  return typeof result === 'object' ? result : obj;\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">// åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼ŒåŒæ—¶ç»‘å®šåŸå‹</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// æ‰§è¡Œæ„é€ å‡½æ•°</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">// è¿”å›æ„é€ ç»“æœæˆ–ä¸´æ—¶å¯¹è±¡</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">result</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"wuwenbang","avatarUrl":"https://avatars.githubusercontent.com/u/64624463?u=40fbf3d5a9bfed590006b6025ed2a32a34fc16a1&v=4","url":"https://github.com/wuwenbang"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASl_J","bodyHTML":"<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/** MDN\n * new è¿ç®—ç¬¦\n *   new è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚\n *\n * new å…³é”®å­—ä¼šè¿›è¡Œå¦‚ä¸‹çš„æ“ä½œï¼š\n *   1. åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å•JavaScriptå¯¹è±¡ï¼ˆå³{}ï¼‰ï¼›\n *   2. ä¸ºæ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡æ·»åŠ å±æ€§__proto__ï¼Œå°†è¯¥å±æ€§é“¾æ¥è‡³æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ ï¼›\n *   3. å°†æ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸ºthisçš„ä¸Šä¸‹æ–‡ ï¼›\n *   4. å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›thisã€‚\n */\n\nfunction MyNew(fn, ...args) {\n  //1\n  const obj = Object.create(null);\n  //2\n  Object.setPrototypeOf(obj, fn.prototype)\n  //3\n  const ret = fn.apply(obj, args);\n  //4\n  return ret instanceof Object ? ret : obj;\n}\n\"><pre class=\"notranslate\"><span class=\"pl-c\">/** MDN</span>\n<span class=\"pl-c\"> * new è¿ç®—ç¬¦</span>\n<span class=\"pl-c\"> *   new è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚</span>\n<span class=\"pl-c\"> *</span>\n<span class=\"pl-c\"> * new å…³é”®å­—ä¼šè¿›è¡Œå¦‚ä¸‹çš„æ“ä½œï¼š</span>\n<span class=\"pl-c\"> *   1. åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å•JavaScriptå¯¹è±¡ï¼ˆå³{}ï¼‰ï¼›</span>\n<span class=\"pl-c\"> *   2. ä¸ºæ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡æ·»åŠ å±æ€§__proto__ï¼Œå°†è¯¥å±æ€§é“¾æ¥è‡³æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ ï¼›</span>\n<span class=\"pl-c\"> *   3. å°†æ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸ºthisçš„ä¸Šä¸‹æ–‡ ï¼›</span>\n<span class=\"pl-c\"> *   4. å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›thisã€‚</span>\n<span class=\"pl-c\"> */</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">//1</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">null</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">//2</span>\n  <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">setPrototypeOf</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">//3</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">ret</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">//4</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">ret</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">ret</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"hanpei","avatarUrl":"https://avatars.githubusercontent.com/u/4035340?u=d1d344898d886fb367b324842eeba71eb4781aca&v=4","url":"https://github.com/hanpei"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASnkq","bodyHTML":"<h1 dir=\"auto\">new å…³é”®å­—</h1>\n<p dir=\"auto\">js ä¸­å®šä¹‰ä¸€ä¸ªç±»</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// å®šä¹‰æ„é€ å‡½æ•°\nfunction Person(name) {\n  console.log('constructor')\n  // å°†æ„é€ å‡½æ•°çš„thisæŒ‡å‘æ–°å¯¹è±¡\n  this.name = name\n}\n\n// å®šä¹‰ç±»çš„å±æ€§\nPerson.prototype.say = function () {\n  console.log('My name is', this.name)\n}\n\n// åˆ›å»ºæ–°å¯¹è±¡\nconst p1 = new Person('tom')\np1.say()\"><pre class=\"notranslate\"><span class=\"pl-c\">// å®šä¹‰æ„é€ å‡½æ•°</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'constructor'</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// å°†æ„é€ å‡½æ•°çš„thisæŒ‡å‘æ–°å¯¹è±¡</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-c\">// å®šä¹‰ç±»çš„å±æ€§</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">say</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">function</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'My name is'</span><span class=\"pl-kos\">,</span> <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-c\">// åˆ›å»ºæ–°å¯¹è±¡</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">p1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'tom'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">p1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">say</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">åœ¨è°ƒç”¨ new æ—¶, ä¸»è¦åšäº† 4 ä»¶äº‹:</p>\n<ol dir=\"auto\">\n<li>\n<p dir=\"auto\">åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡</p>\n</li>\n<li>\n<p dir=\"auto\">å°†ç©ºå¯¹è±¡çš„ <code class=\"notranslate\">__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code class=\"notranslate\">prototype</code></p>\n</li>\n<li>\n<p dir=\"auto\">æ‰§è¡Œæ„é€ å‡½æ•°, å¹¶å°†æ–°åˆ›å»ºçš„ç©ºå¯¹è±¡ç»‘å®šä¸ºæ„é€ å‡½æ•°çš„ this å¯¹è±¡</p>\n</li>\n<li>\n<p dir=\"auto\">å¦‚æœæ„é€ å‡½æ•°æœ‰è¿”å›ä¸€ä¸ªå¯¹è±¡,åˆ™è¿”å›è¿™ä¸ªå¯¹è±¡,å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡</p>\n</li>\n</ol>\n<p dir=\"auto\">æ ¹æ®ä»¥ä¸Šè§„åˆ™,æˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿå®ç°ä¸€ä¸ª new å‡½æ•°</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(constructorFn, ...args) {\n  // 1. åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡\n  const obj = {}\n  // 2. å°†ç©ºå¯¹è±¡çš„__proto__æŒ‡å‘constructorçš„prototype\n  obj.__proto__ = constructorFn.prototype\n  // 3. æ‰§è¡Œ constructor, å¹¶å°†æ–°å¯¹è±¡ç»‘å®šä¸ºconstructorçš„thiså¯¹è±¡\n  const res = constructorFn.apply(obj, args)\n  // 4. å¦‚æœæ„é€ å‡½æ•°æœ‰è¿”å›å€¼åˆ™è¿”å›res,å¦åˆ™è¿”å›æ–°å¯¹è±¡\n  return typeof res === 'object' ? res : obj\n}\n\nconst p1 = myNew(Person, 'jack')\np1.say()\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">constructorFn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">// 1. åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n  <span class=\"pl-c\">// 2. å°†ç©ºå¯¹è±¡çš„__proto__æŒ‡å‘constructorçš„prototype</span>\n  <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">__proto__</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">constructorFn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span>\n  <span class=\"pl-c\">// 3. æ‰§è¡Œ constructor, å¹¶å°†æ–°å¯¹è±¡ç»‘å®šä¸ºconstructorçš„thiså¯¹è±¡</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">constructorFn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// 4. å¦‚æœæ„é€ å‡½æ•°æœ‰è¿”å›å€¼åˆ™è¿”å›res,å¦åˆ™è¿”å›æ–°å¯¹è±¡</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'object'</span> ? <span class=\"pl-s1\">res</span> : <span class=\"pl-s1\">obj</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">p1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'jack'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">p1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">say</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span></pre></div>","author":{"login":"RJM1996","avatarUrl":"https://avatars.githubusercontent.com/u/33800707?u=10830efddf4f630f3ea3d4b89d34130f05cfb835&v=4","url":"https://github.com/RJM1996"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASoOw","bodyHTML":"<h3 dir=\"auto\">å†…éƒ¨å·¥ä½œæµç¨‹ï¼š</h3>\n<ol dir=\"auto\">\n<li>æ£€æµ‹ new çš„ç›®æ ‡æ˜¯ä¸æ˜¯éå‡½æ•°ï¼Œå¦‚æœæ˜¯éå‡½æ•°ï¼ŒæŠ›å‡ºé”™è¯¯</li>\n<li>ä¿®æ”¹ new çš„ target å±æ€§ï¼Œä½¿ä¹‹æŒ‡å‘æ„é€ å‡½æ•°</li>\n<li>æ–°å»ºä¸€ä¸ªç©ºçš„å®ä¾‹å¯¹è±¡ã€‚æ³¨æ„ä¸èƒ½ä½¿ç”¨ <code class=\"notranslate\">Object.create</code> åˆ›å»ºï¼Œå¦åˆ™å½“æ„é€ å‡½æ•°åŸå‹ä¸º <code class=\"notranslate\">null</code> çš„æ—¶å€™ï¼Œå®ä¾‹å¯¹è±¡éšå¼åŸå‹ä¹Ÿä¸º <code class=\"notranslate\">null</code>ï¼Œä½†æ ¹æ® new çš„<a href=\"https://262.ecma-international.org/5.1/#sec-11.2.2\" rel=\"nofollow\">è§„èŒƒ</a>ï¼Œè¿™é‡Œä¸æ˜¯è¿™æ ·çš„ã€‚å…·ä½“è§ 4ã€‚</li>\n<li>æ£€æµ‹æ„é€ å‡½æ•°åŸå‹æ˜¯å¦ä¸º <code class=\"notranslate\">null</code>ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å°†å…¶ä½œä¸ºå®ä¾‹å¯¹è±¡çš„éšå¼åŸå‹ï¼Œå¦åˆ™å°† Object çš„åŸå‹ä½œä¸ºå®ä¾‹å¯¹è±¡çš„éšå¼åŸå‹</li>\n<li>æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå°†å…¶ this æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼ŒåŒæ—¶ä¼ å…¥å‚æ•°</li>\n<li>è·å¾—æ„é€ å‡½æ•°è¿”å›å€¼ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™ä½œä¸º new çš„è¿”å›å€¼ï¼Œå¦åˆ™å°†å®ä¾‹å¯¹è±¡ä½œä¸º new çš„è¿”å›å€¼</li>\n</ol>\n<h3 dir=\"auto\">ä»£ç å®ç°ï¼š</h3>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function myNew(Fn,...args){\n   // æ£€æµ‹å¼‚å¸¸\n    if(typeof Fn != 'function'){\n        throw new TypeError(Fn + 'is not a constructor')\n    }\n  // ä¿®æ”¹ target å±æ€§\n    myNew.target = Fn\n  // åˆ›å»ºç©ºçš„å®ä¾‹å¯¹è±¡\n    const instance = {}\n    // æ£€æµ‹æ„é€ å‡½æ•°åŸå‹æ˜¯ä¸æ˜¯å¯¹è±¡\n    instance.__proto__ = Fn.prototype instanceof Object ? Fn.prototype : Object.prototype \n   // æ‰§è¡Œæ„é€ å‡½æ•°\n    const returnValue = Fn.call(instance,...args)\n  // å†³å®š new çš„è¿”å›å€¼\n    return returnValue instanceof Object ? returnValue : instance\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Fn</span><span class=\"pl-kos\">,</span>...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span>\n   <span class=\"pl-c\">// æ£€æµ‹å¼‚å¸¸</span>\n    <span class=\"pl-k\">if</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-v\">Fn</span> <span class=\"pl-c1\">!=</span> <span class=\"pl-s\">'function'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span>\n        <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">TypeError</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Fn</span> <span class=\"pl-c1\">+</span> <span class=\"pl-s\">'is not a constructor'</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-c\">// ä¿®æ”¹ target å±æ€§</span>\n    <span class=\"pl-s1\">myNew</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Fn</span>\n  <span class=\"pl-c\">// åˆ›å»ºç©ºçš„å®ä¾‹å¯¹è±¡</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">instance</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n    <span class=\"pl-c\">// æ£€æµ‹æ„é€ å‡½æ•°åŸå‹æ˜¯ä¸æ˜¯å¯¹è±¡</span>\n    <span class=\"pl-s1\">instance</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">__proto__</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> : <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> \n   <span class=\"pl-c\">// æ‰§è¡Œæ„é€ å‡½æ•°</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">returnValue</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">instance</span><span class=\"pl-kos\">,</span>...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-c\">// å†³å®š new çš„è¿”å›å€¼</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">returnValue</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">returnValue</span> : <span class=\"pl-s1\">instance</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<h3 dir=\"auto\">æµ‹è¯•ï¼š</h3>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// æ„é€ å‡½æ•°åŸå‹ä¸ä¸ºç©ºçš„æƒ…å†µ\nfunction Student(name,age){\n    this.name = name\n    this.age = age\n}\nconst student1 = myNew(Student,'Jack',20)\nconst student2 = new Student('Jack',20)\nconsole.log(student1)                     // {name:'Jack',age:20}\nconsole.log(student2)                     // {name:'Jack',age:20}\n\n// æ„é€ å‡½æ•°åŸå‹ä¸ºç©ºçš„æƒ…å†µ\nfunction Fn(){}\nFn.prototype = null\nconst fn1 = myNew(Fn)\nconst fn2 = new Fn()\nObject.getPrototypeOf(fn1) === Object.prototype           // true\nObject.getPrototypeOf(fn2) === Object.prototype           // true\"><pre class=\"notranslate\"><span class=\"pl-c\">// æ„é€ å‡½æ•°åŸå‹ä¸ä¸ºç©ºçš„æƒ…å†µ</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Student</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">age</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span>\n    <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span>\n    <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">age</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">age</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">student1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Student</span><span class=\"pl-kos\">,</span><span class=\"pl-s\">'Jack'</span><span class=\"pl-kos\">,</span><span class=\"pl-c1\">20</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">student2</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Student</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'Jack'</span><span class=\"pl-kos\">,</span><span class=\"pl-c1\">20</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">student1</span><span class=\"pl-kos\">)</span>                     <span class=\"pl-c\">// {name:'Jack',age:20}</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">student2</span><span class=\"pl-kos\">)</span>                     <span class=\"pl-c\">// {name:'Jack',age:20}</span>\n\n<span class=\"pl-c\">// æ„é€ å‡½æ•°åŸå‹ä¸ºç©ºçš„æƒ…å†µ</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n<span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">null</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">fn1</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">myNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Fn</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">fn2</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">getPrototypeOf</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn1</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">===</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span>           <span class=\"pl-c\">// true</span>\n<span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">getPrototypeOf</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn2</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">===</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span>           <span class=\"pl-c\">// true</span></pre></div>","author":{"login":"Chorer","avatarUrl":"https://avatars.githubusercontent.com/u/43442630?u=a9fa211751f51a129ea1fdd6ebaaa8ab41edb62a&v=4","url":"https://github.com/Chorer"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASoxE","bodyHTML":"<p dir=\"auto\">function myNew(argument) {<br>\nlet content = {} //ç”Ÿæˆä¸€ä¸ªå¯¹è±¡<br>\nlet args = Array.prototype.slice.call(argument,0) //å‚æ•°<br>\nlet constructor =  args.shift()//è·å¾—æ„é€ å‡½æ•°<br>\ncontent.<strong>proto</strong> = constructor.prototype //ç©ºå¯¹è±¡åŸå‹æŒ‡å‘è¿™ä¸ªæ„é€ å‡½æ•° content.<strong>proto</strong><br>\nconstructor.apply(content,args)//æ„é€ å‡½æ•°æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œå€¼ä¸ºargs<br>\nreturn content //è¿”å›æ–°å¯¹è±¡<br>\n}</p>","author":{"login":"w615","avatarUrl":"https://avatars.githubusercontent.com/u/61973759?u=c5e6d384e2c49f6790aa493ab3ee931770c60952&v=4","url":"https://github.com/w615"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85AStrb","bodyHTML":"<p dir=\"auto\">å®ç°new åˆ›å»ºå®ä¾‹çš„æ­¥éª¤ï¼š<br>\n1ã€åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡<br>\n2ã€å°†è¿™ä¸ªæ–°å¯¹è±¡çš„åŸå‹å…³è”åˆ°è¯¥æ„é€ å‡½æ•°çš„prototypeä¸Š<br>\n3ã€åˆ¤æ–­è¯¥æ„é€ å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™ç›´æ¥è¿”å›è¯¥å€¼ï¼Œåä¹‹ï¼Œè¿”å›ç©ºå¯¹è±¡</p>\n<p dir=\"auto\">function MyNew(targetFn, ...arg) {<br>\nconst obj = {};<br>\nobj.<strong>proto</strong> = targetFn.protoType;<br>\nconst res = targetFn.apply(obj, [...arg]);<br>\nreturn typeof res === 'object' ? res : obj;<br>\n}<br>\n//æµ‹è¯•ç”¨ä¾‹<br>\nfunction Foo(name) {<br>\nthis.name = name;<br>\n};<br>\nFoo.prototype.changeName = (name) =&gt; { this.name = name };<br>\nconst instance = MyNew(Foo, 'å¼ ä¸‰');<br>\nconsole.log(instance)</p>","author":{"login":"xietingyang","avatarUrl":"https://avatars.githubusercontent.com/u/83275292?v=4","url":"https://github.com/xietingyang"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASwBE","bodyHTML":"<h3 dir=\"auto\">æ€è·¯(æ ¹æ® new çš„æ‰§è¡ŒåŸç†æ¥mock)</h3>\n<ol dir=\"auto\">\n<li>è°ƒç”¨æ–¹å¼ new Person('name', 'age'); MyNew åˆ™æ¥æ”¶å¤šä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºæ„é€ å‡½æ•°ï¼Œå‰©ä½™ä¸ºæ„é€ å‡½æ•°æ‰€éœ€çš„å‚æ•°ã€‚</li>\n<li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡çš„åŸå‹é“¾æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹ï¼ˆæ ‡æ³¨1ï¼‰ä½¿è¯¥å¯¹è±¡å…·æœ‰æ„é€ å‡½æ•°åŸå‹ä¸Šçš„æ–¹æ³•ã€‚</li>\n<li>æ„é€ å‡½æ•°æ‰§è¡Œéœ€æ‰§è¡Œthisä¸ºæ–°å»ºçš„å¯¹è±¡ï¼ˆæ ‡æ³¨2ï¼‰ã€‚</li>\n<li>è¿”å›å€¼é»˜è®¤æ˜¯è¯¥æ„é€ å‡½æ•°å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œä½†å¦‚æœè¯¥æ„é€ å‡½æ•°å¼ºåˆ¶è¿”å›äº†éå¼•ç”¨ç±»å‹åˆ™éœ€è¦è¿”å›å‰é¢æ–°å»ºçš„å¯¹è±¡ ï¼ˆæ ‡æ³¨3ï¼‰ã€‚</li>\n</ol>\n<h3 dir=\"auto\">ä»£ç å®ç° ï¼ˆæµ‹è¯•ç”¨ä¾‹å‡é€šè¿‡ï¼‰</h3>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew(fn, ...args) {\n // æ ‡æ³¨1\n  let obj = Object.create(fn.prototype);\n // æ ‡æ³¨2\n  let res = fn.apply(obj, args);\n  // æ ‡æ³¨3\n  if ((typeof res === &quot;object&quot; &amp;&amp; res !== null) || typeof res === &quot;function&quot;) {\n    return res;\n  }\n  return obj;\n}\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n <span class=\"pl-c\">// æ ‡æ³¨1</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n <span class=\"pl-c\">// æ ‡æ³¨2</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">// æ ‡æ³¨3</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">\"object\"</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">null</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">||</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">\"function\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span></pre></div>","author":{"login":"fanerge","avatarUrl":"https://avatars.githubusercontent.com/u/17136707?u=d7250b0655c87b8e8e1cdaf826754fe5e6f68e80&v=4","url":"https://github.com/fanerge"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85ASwUb","bodyHTML":"<p dir=\"auto\">åŸç†ï¼š</p>\n<ul dir=\"auto\">\n<li>new é¦–å…ˆä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªç©ºå¯¹è±¡çš„<code class=\"notranslate\">__proto__</code>æŒ‡å‘æ„é€ å‡½æ•°çš„<code class=\"notranslate\">prototype</code>ï¼Œä»è€Œç»§æ‰¿æ„é€ å‡½æ•°åŸå‹ä¸Šçš„æ–¹æ³•ï¼ˆï¼‰</li>\n<li>å°†this<strong>æŒ‡å‘åˆšåˆšåˆ›å»ºçš„æ–°å¯¹è±¡</strong>ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼Œä»¥è·å–ç§æœ‰å±æ€§å’Œæ–¹æ³•</li>\n<li>å¦‚æœæ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡resï¼Œå°±å°†è¯¥è¿”å›å€¼å¯¹è±¡resè¿”å›,å¦‚æœè¿”å›çš„ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™å°†åˆ›å»ºçš„æ–°å¯¹è±¡è¿”å›</li>\n</ul>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function MyNew(Fn, ...args) {  //å°†ä¸å®šæ•°é‡çš„å‚æ•°è¡¨ç¤ºä¸ºä¸€ä¸ªæ•°ç»„\n  //1.åˆ›å»ºç©ºå¯¹è±¡objï¼Œå¹¶å°†obj._proto_æŒ‡å‘æ„é€ å‡½æ•°Fn.prototype\n  const obj = Object.create(Fn.prototype);\n  //2.å°†æ„é€ å‡½æ•°Fnçš„thisæŒ‡å‘obj,å¹¶æ‰§è¡ŒFnä»£ç ï¼Œè·å¾—è¿”å›å€¼\n  const res = Fn.apply(obj, args); //argsæ˜¯æ•°ç»„['dy','ç”·']\n  //3.æ ¹æ®è¿”å›å€¼ç±»å‹ï¼Œå†³å®šåˆ°åº•è¿”å›è°\n  return res instanceof Object ? res : obj;\n}\n\n//æ„é€ å‡½æ•°\nfunction Person(name, sex) {\n  this.name = name;\n  this.sex = sex;\n}\nPerson.prototype.getName = function () {\n  return this.name;\n};\nPerson.getSex = 'bukeyisese'\n\nconst ymy = new Person(&quot;ymy&quot;, &quot;å¥³&quot;);\nconst dy = MyNew(Person, &quot;dy&quot;, &quot;ç”·&quot;);\nconsole.log(ymy);\nconsole.log(dy);\nconsole.log(dy.getName());\n//å…±äº«åŸå‹ä¸Šçš„æ–¹æ³•\nconsole.log(ymy.getName === dy.getName); //true\"><pre class=\"notranslate\"><span class=\"pl-k\">function</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Fn</span><span class=\"pl-kos\">,</span> ...<span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>  <span class=\"pl-c\">//å°†ä¸å®šæ•°é‡çš„å‚æ•°è¡¨ç¤ºä¸ºä¸€ä¸ªæ•°ç»„</span>\n  <span class=\"pl-c\">//1.åˆ›å»ºç©ºå¯¹è±¡objï¼Œå¹¶å°†obj._proto_æŒ‡å‘æ„é€ å‡½æ•°Fn.prototype</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">obj</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">//2.å°†æ„é€ å‡½æ•°Fnçš„thisæŒ‡å‘obj,å¹¶æ‰§è¡ŒFnä»£ç ï¼Œè·å¾—è¿”å›å€¼</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">res</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Fn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">obj</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">args</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span> <span class=\"pl-c\">//argsæ˜¯æ•°ç»„['dy','ç”·']</span>\n  <span class=\"pl-c\">//3.æ ¹æ®è¿”å›å€¼ç±»å‹ï¼Œå†³å®šåˆ°åº•è¿”å›è°</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">res</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-v\">Object</span> ? <span class=\"pl-s1\">res</span> : <span class=\"pl-s1\">obj</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-c\">//æ„é€ å‡½æ•°</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">sex</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">sex</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">sex</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">getName</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">function</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-smi\">this</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">getSex</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'bukeyisese'</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">ymy</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"ymy\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"å¥³\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">dy</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">MyNew</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"dy\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"ç”·\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ymy</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">dy</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">dy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">getName</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-c\">//å…±äº«åŸå‹ä¸Šçš„æ–¹æ³•</span>\n<span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ymy</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">getName</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s1\">dy</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">getName</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span> <span class=\"pl-c\">//true</span></pre></div>\n<ul dir=\"auto\">\n<li>å‰©ä½™å‚æ•°ï¼šå¦‚æœå‡½æ•°çš„æœ€åä¸€ä¸ªå‘½åå‚æ•°ä»¥<code class=\"notranslate\">...</code>ä¸ºå‰ç¼€ï¼Œåˆ™å®ƒå°†æˆä¸ºä¸€ä¸ªç”±å‰©ä½™å‚æ•°ç»„æˆçš„çœŸæ•°ç»„ã€‚</li>\n<li><code class=\"notranslate\">Object.create()</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†æ–°åˆ›å»ºçš„å¯¹è±¡çš„<code class=\"notranslate\">__proto__</code>æŒ‡å‘ä¼ å…¥çš„å¯¹è±¡çš„åŸå‹ã€‚</li>\n</ul>","author":{"login":"Travelguest","avatarUrl":"https://avatars.githubusercontent.com/u/42471249?u=da42abea217ddf6f316e2b887c7e2d270566f854&v=4","url":"https://github.com/Travelguest"},"replies":null}},{"node":{"id":"IC_kwDOHCfdf85AU13K","bodyHTML":"<p dir=\"auto\">è¿™é‡Œ <a href=\"https://github.com/toFrankie/Blog/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/toFrankie/blog/issues/1/hovercard\">æ‰‹å†™ç³»åˆ—ä¹‹ new å…³é”®å­—çš„å®ç° #1</a></p>","author":{"login":"toFrankie","avatarUrl":"https://avatars.githubusercontent.com/u/26947203?u=6b911102f09bb218a5d6cc053ffe3132eb6d3f21&v=4","url":"https://github.com/toFrankie"},"replies":null}}]}}},"pageContext":{"number":15,"previous":{"title":"å®ç°ä¸€ä¸ªLazyMan","number":13},"next":{"title":"å¦‚ä½•å‡†å¤‡è¿°èŒæŠ¥å‘Šï¼Ÿ","number":16}}},
    "staticQueryHashes": ["151096407","2861350382"]}